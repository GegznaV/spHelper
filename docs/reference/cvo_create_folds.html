<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>[!] Create indices of folds with blocking and stratification (cvo object) � cvo_create_folds • spHelper</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  	<link rel="icon" href="../favicon.png" />
</head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">spHelper | R package</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v1_spHelper_Plotting.html">`spHelper` Plotting Examples</a>
    </li>
    <li>
      <a href="../articles/v2_Other_Examples.html">Other `spHelper` examples</a>
    </li>
    <li>
      <a href="../articles/v3_Plotting_Examples_gg_hy.html">`hyperSpec` Plotting Examples with `ggplot2`</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GegznaV/spHelper">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>[!] Create indices of folds with blocking and stratification (cvo object)</h1>
    </div>

    
    <p><b>[DESCRIBTION MUST BE UPDATED]</b>
Create indices of folds with blocking and stratification for (repeated)
k-fold cross-validation. 
Function <code>cvo_create_folds</code> randomly divides observations into
folds that are used for (repeated) k-fold cross-validation. In these
 folds observations are:</p><ol>
<li><p><b>blocked</b> by values in variable <code>block_by</code>
     (i.e. observations with the same "ID" or other kind of blocking factor
     are treated as one unit (a block) and are always in the same fold);</p></li>
<li><p><b>stratified</b> by levels of factor variable <code>stratify_by</code>
      (the proportions of these grouped units of observations per each
      group (level) are kept approximately constant throughout all folds).</p></li>
</ol>
    

    <pre class="usage"><span class='fu'>cvo_create_folds</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>stratify_by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>block_by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>folds</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seeds</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"caret"</span>, <span class='st'>"mlr"</span>)[<span class='fl'>1</span>],
  <span class='kw'>returnTrain</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>, <span class='st'>"both"</span>)[<span class='fl'>1</span>], <span class='kw'>predict</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"test"</span>, <span class='st'>"train"</span>,
  <span class='st'>"both"</span>)[<span class='fl'>1</span>], <span class='kw'>folds</span> <span class='kw'>=</span> <span class='fl'>5</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame, that contains variables which names are denoted
by arguments <code>block_by</code> and by <code>stratify_by</code>.</p></td>
    </tr>
    <tr>
      <th>stratify_by</th>
      <td><p>A vector or a name of factor variable in <code>data</code>,
which levels will be used for <em>stratification</em>. E.g.,
a vector with medical groups.</p></td>
    </tr>
    <tr>
      <th>block_by</th>
      <td><p>A vector or a name of variable in <code>data</code>, that
contains identification codes/numbers (ID). These codes
will be used for blocking.</p></td>
    </tr>
    <tr>
      <th>k, folds</th>
      <td><p>(<code>integer</code>) A number of folds, default <code>k = 5</code>.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>(<code>integer</code>) a number of repetitions for
repeated cross-validation.</p></td>
    </tr>
    <tr>
      <th>seeds</th>
      <td><p>(vector of integers | <code>NULL</code>) Seeds for random number
            generator for each repetition.
            If <code>seeds = NULL</code> random seeds are generated.
            If number of repetitions is
            greater than number of provided seeds, random seeds are
            generated and added to the provided ones. The first seed will
            be used to ensure reproducibility of the randomly generated
            seeds.</p>
<p>(See <code><a href='http://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></code> for more information about
             random number generation).</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>(<code>character</code>) Either <span class="pkg">caret</span>-like or <span class="pkg">mlr</span>-like
cvo object. <b>This option is not implemented yet!</b></p></td>
    </tr>
    <tr>
      <th>returnTrain</th>
      <td><p>(<code>logical</code> | <code>character</code>) 
If <code>TRUE</code>, returns indices of variables in
a training set (<span class="pkg">caret</span> style).
If <code>FALSE</code>, returns indices of variables in
a test set (<span class="pkg">caret</span> style).
If <code>"both"</code>, returns indices of
variables in both training and test sets (<span class="pkg">mlr</span> style).</p></td>
    </tr>
    <tr>
      <th>predict</th>
      <td><p>[<code>character(1)</code>]
What to predict during resampling: &#8220;train&#8221;, &#8220;test&#8221; or &#8220;both&#8221; sets.
Default is &#8220;test&#8221;.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(<code>list</code>) A list of folds. In each fold there are indices
        observations. The structure of outputs is the similar to one
        created with either function <code><a href='http://www.rdocumentation.org/packages/caret/topics/createDataPartition'>createFolds</a>()</code>
        from <span class="pkg">caret</span> or function
        <code><a href='http://www.rdocumentation.org/packages/mlr/topics/makeResampleInstance'>makeResampleInstance</a>()</code> in <span class="pkg">mlr</span>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If <code>k</code> is such big, that some folds have no observations of
      a certain group (i.e., level in <code>stratify_by</code>), an error
      is returned. In that case smaller value of <code>k</code> may be
      recommended.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Function <code><a href='http://www.rdocumentation.org/packages/caret/topics/createDataPartition'>createFolds</a></code> from package
         <span class="pkg">caret</span>. 
         Function <code><a href='http://www.rdocumentation.org/packages/mlr/topics/makeResampleInstance'>makeResampleInstance</a></code> from package
         <span class="pkg">mlr</span>. 
Test if folds are blocked and stratified <code><a href='test_folds_BS.html'>test_folds_BS</a></code></p>
<p>Other <span class="pkg">spHelper</span> fold creation functions: <code><a href='cvo_get_info.html'>cvo_get_info</a></code>,
  <code><a href='cvo_test_bs.html'>cvo_test_bs</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>spHelper</span>)

<span class='co'># Load data</span>
     <span class='fu'>data</span>(<span class='st'>"DataSet1"</span>)

<span class='co'># Explore data</span>
     <span class='fu'>str</span>(<span class='no'>DataSet1</span>)</div><div class='output co'>#&gt; 'data.frame':	40 obs. of  3 variables:
#&gt;  $ ID  : Factor w/ 20 levels "1","2","3","4",..: 1 1 2 2 3 3 4 4 5 5 ...
#&gt;  $ gr  : Factor w/ 4 levels "A","B","C","D": 1 1 1 1 1 1 1 1 1 1 ...
#&gt;  $ .row: int  1 2 3 4 5 6 7 8 9 10 ...</div><div class='input'>     <span class='fu'>table</span>(<span class='no'>DataSet1</span>[,<span class='fu'>c</span>(<span class='st'>"gr"</span>,<span class='st'>"ID"</span>)])</div><div class='output co'>#&gt;    ID
#&gt; gr  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
#&gt;   A 2 2 2 2 2 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0
#&gt;   B 0 0 0 0 0 2 2 2 2  2  0  0  0  0  0  0  0  0  0  0
#&gt;   C 0 0 0 0 0 0 0 0 0  0  2  2  2  2  2  0  0  0  0  0
#&gt;   D 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  2  2  2  2  2</div><div class='input'>     <span class='fu'>summary</span>(<span class='no'>DataSet1</span>)</div><div class='output co'>#&gt;        ID     gr          .row      
#&gt;  1      : 2   A:10   Min.   : 1.00  
#&gt;  2      : 2   B:10   1st Qu.:10.75  
#&gt;  3      : 2   C:10   Median :20.50  
#&gt;  4      : 2   D:10   Mean   :20.50  
#&gt;  5      : 2          3rd Qu.:30.25  
#&gt;  6      : 2          Max.   :40.00  
#&gt;  (Other):28                         </div><div class='input'>
<span class='co'># Explore functions</span>
     <span class='no'>nFolds</span> <span class='kw'>=</span> <span class='fl'>5</span>

<span class='co'># If variables of data frame are provided:</span>
     <span class='no'>Folds1_a</span> <span class='kw'>&lt;-</span> <span class='fu'>cvo_create_folds</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>DataSet1</span>,
                              <span class='kw'>stratify_by</span> <span class='kw'>=</span> <span class='st'>"gr"</span>, <span class='kw'>block_by</span> <span class='kw'>=</span> <span class='st'>"ID"</span>,
                               <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>nFolds</span>, <span class='kw'>returnTrain</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
     <span class='co'># str(Folds1_a)</span>
     <span class='fu'><a href='cvo_test_bs.html'>cvo_test_bs</a></span>(<span class='no'>Folds11_a</span>, <span class='st'>"gr"</span>, <span class='st'>"ID"</span>, <span class='no'>DataSet1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in lapply(obj, make_table, By): object 'Folds11_a' not found</span></div><div class='input'>
<span class='co'># If "free" variables are provided:</span>
     <span class='no'>Folds1_b</span> <span class='kw'>&lt;-</span> <span class='fu'>cvo_create_folds</span>(<span class='kw'>gr</span> <span class='kw'>=</span> <span class='no'>DataSet1</span>$<span class='no'>gr</span>, <span class='kw'>ID</span> <span class='kw'>=</span> <span class='no'>DataSet1</span>$<span class='no'>ID</span>,
                                <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>nFolds</span>, <span class='kw'>returnTrain</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in cvo_create_folds(gr = DataSet1$gr, ID = DataSet1$ID, k = nFolds,     returnTrain = FALSE): unused arguments (gr = DataSet1$gr, ID = DataSet1$ID)</span></div><div class='input'>     <span class='co'># str(Folds1_b)</span>
     <span class='fu'><a href='cvo_test_bs.html'>cvo_test_bs</a></span>(<span class='no'>Folds11_b</span>, <span class='st'>"gr"</span>, <span class='st'>"ID"</span>, <span class='no'>DataSet1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in lapply(obj, make_table, By): object 'Folds11_b' not found</span></div><div class='input'>
<span class='co'># Not blocked but stratified</span>
     <span class='no'>Folds1_c</span> <span class='kw'>&lt;-</span> <span class='fu'>cvo_create_folds</span>(<span class='kw'>gr</span> <span class='kw'>=</span> <span class='no'>DataSet1</span>$<span class='no'>gr</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='no'>nFolds</span>, <span class='kw'>returnTrain</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in cvo_create_folds(gr = DataSet1$gr, k = nFolds, returnTrain = FALSE): unused argument (gr = DataSet1$gr)</span></div><div class='input'>     <span class='co'># str(Folds1_c)</span>
     <span class='fu'><a href='cvo_test_bs.html'>cvo_test_bs</a></span>(<span class='no'>Folds11_c</span>, <span class='st'>"gr"</span>, <span class='st'>"ID"</span>, <span class='no'>DataSet1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in lapply(obj, make_table, By): object 'Folds11_c' not found</span></div><div class='input'>
<span class='co'># Blocked but not stratified</span>
     <span class='no'>Folds1_d</span> <span class='kw'>&lt;-</span> <span class='fu'>cvo_create_folds</span>(<span class='kw'>block_by</span> <span class='kw'>=</span> <span class='no'>DataSet1</span>$<span class='no'>ID</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>nFolds</span>, <span class='kw'>returnTrain</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
     <span class='co'># str(Folds1_d)</span>
     <span class='fu'><a href='cvo_test_bs.html'>cvo_test_bs</a></span>(<span class='no'>Folds11_d</span>, <span class='st'>"gr"</span>, <span class='st'>"ID"</span>, <span class='no'>DataSet1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in lapply(obj, make_table, By): object 'Folds11_d' not found</span></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Vilmantas Gegzna

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Vilmantas Gegzna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
